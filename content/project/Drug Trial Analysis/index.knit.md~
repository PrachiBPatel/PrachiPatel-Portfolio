---
title: "Drug Trial Analysis"
subtitle: ""
author: "Prachi Patel"
date: "2022-10-14"
output: pdf_document

---

500 patients participated in a new drug trial designed to increase the white blood cell count (WBC). One group of patients (“Treat”) were given the medication while the other (“Control”) were not. A number of variables were measured and recorded (including a survey they were asked to fill in). Appendix 1 contains the data dictionary for the data set. One group of respondents (“Treat”) were given additional education on political matters while the other (“Control”) were not.
    

This section is for the basic set up.
It will clear all the plots, the console and the workspace.
It also sets the overall format for numbers.


```r
if(!is.null(dev.list())) dev.off()
```

```
## null device 
##           1
```

```r
cat("\014") 
```



```r
rm(list=ls())
options(scipen=9)
```

This section loads and attaches all the necessary packages.


```r
if(!require(readxl)){install.packages("readxl")}
```

```
## Loading required package: readxl
```

```r
library("readxl")

if(!require(pastecs)){install.packages("pastecs")}
```

```
## Loading required package: pastecs
```

```r
library("pastecs")

if(!require(lattice)){install.packages("lattice")}
```

```
## Loading required package: lattice
```

```r
library("lattice")

if(!require(ggplot2)){install.packages("ggplot2")}
```

```
## Loading required package: ggplot2
```

```r
library("ggplot2")

if(!require(tinytex)){install.packages("tinytex")}
```

```
## Loading required package: tinytex
```

```r
library("tinytex")
```




1. Data Transformation and Preparation

  1. Initial Transformation
    a. Rename all variables with your initials appended (just as was done in assignment 1 and 2)
      ->To append initials in the data frame we can use paste function to concatenate value and added _ as a separator.


```r
colnames(ExcelFile) <- paste(colnames(ExcelFile), "", sep = "_")
head(ExcelFile)
```

```
##   ID_ gender_  HR_  BP_ Wgt1_ Wgt2_ Exercise_ Hgt_ Smoke_ Drink_  Group_ WBC_
## 1   1  female Norm Norm 118.6 121.5       158 67.8      N      Y Control 5193
## 2   2  female Norm Norm 143.1 146.6       152 65.9      N      Y Control 5705
## 3   3  female Norm High 105.3 107.3       205 69.3      N      N    Test 7680
## 4   4  female Norm Norm 119.5 120.9       151 65.4      N      Y Control 7342
## 5   5  female Norm High 130.9 132.1       178 65.8      N      N Control 7714
## 6   6  female Norm High  90.0  91.4       204 63.1      N      Y Control 3851
##   Income_
## 1  125000
## 2      NA
## 3      NA
## 4      NA
## 5      NA
## 6      NA
```

    b. Transform character variables to factor variables.
      -> Using factor function we can convert character variable to factor variable.
        

```r
ExcelFile$gender <- as.factor(ExcelFile$gender)
ExcelFile$HR <- as.factor(ExcelFile$HR)
ExcelFile$BP <- as.factor(ExcelFile$BP)
ExcelFile$Smoke <- as.factor(ExcelFile$Smoke)
ExcelFile$Drink <- as.factor(ExcelFile$Drink)
ExcelFile$Group <- as.factor(ExcelFile$Group)
head(ExcelFile)
```

```
##   ID_ gender_  HR_  BP_ Wgt1_ Wgt2_ Exercise_ Hgt_ Smoke_ Drink_  Group_ WBC_
## 1   1  female Norm Norm 118.6 121.5       158 67.8      N      Y Control 5193
## 2   2  female Norm Norm 143.1 146.6       152 65.9      N      Y Control 5705
## 3   3  female Norm High 105.3 107.3       205 69.3      N      N    Test 7680
## 4   4  female Norm Norm 119.5 120.9       151 65.4      N      Y Control 7342
## 5   5  female Norm High 130.9 132.1       178 65.8      N      N Control 7714
## 6   6  female Norm High  90.0  91.4       204 63.1      N      Y Control 3851
##   Income_ gender   HR   BP Smoke Drink   Group
## 1  125000 female Norm Norm     N     Y Control
## 2      NA female Norm Norm     N     Y Control
## 3      NA female Norm High     N     N    Test
## 4      NA female Norm Norm     N     Y Control
## 5      NA female Norm High     N     N Control
## 6      NA female Norm High     N     Y Control
```

  2. Reduce Dimensionality
  
    a. Apply the Missing Value Filter to remove appropriate columns of data.
      -> Using summary function, we can summarize all data in the data source. Based on the summary data 492 values out of 500 is blank or null for Income field.
    

```r
summary(ExcelFile)
```

```
##       ID_          gender_              HR_                BP_           
##  Min.   :  1.0   Length:500         Length:500         Length:500        
##  1st Qu.:125.8   Class :character   Class :character   Class :character  
##  Median :250.5   Mode  :character   Mode  :character   Mode  :character  
##  Mean   :250.5                                                           
##  3rd Qu.:375.2                                                           
##  Max.   :500.0                                                           
##                                                                          
##      Wgt1_           Wgt2_         Exercise_          Hgt_      
##  Min.   : 49.2   Min.   : 50.2   Min.   : 67.0   Min.   :59.80  
##  1st Qu.:114.3   1st Qu.:115.2   1st Qu.:147.0   1st Qu.:65.00  
##  Median :131.7   Median :133.7   Median :175.5   Median :67.05  
##  Mean   :131.0   Mean   :132.9   Mean   :176.9   Mean   :67.01  
##  3rd Qu.:149.6   3rd Qu.:151.6   3rd Qu.:207.0   3rd Qu.:69.00  
##  Max.   :199.3   Max.   :201.5   Max.   :297.0   Max.   :78.90  
##                                                                 
##     Smoke_             Drink_             Group_               WBC_      
##  Length:500         Length:500         Length:500         Min.   : 3851  
##  Class :character   Class :character   Class :character   1st Qu.: 6195  
##  Mode  :character   Mode  :character   Mode  :character   Median : 6902  
##                                                           Mean   : 6896  
##                                                           3rd Qu.: 7532  
##                                                           Max.   :10652  
##                                                                          
##     Income_          gender       HR         BP      Smoke   Drink  
##  Min.   :  2000   female:500   High: 77   High: 94   N:427   N:140  
##  1st Qu.:  7000                Low : 18   Low : 34   Y: 73   Y:360  
##  Median : 53500                Norm:405   Norm:372                  
##  Mean   : 66625                                                     
##  3rd Qu.:128000                                                     
##  Max.   :148000                                                     
##  NA's   :492                                                        
##      Group    
##  Control:250  
##  Test   :250  
##               
##               
##               
##               
## 
```

```r
ExcelFile <- ExcelFile[-c(13)]
summary(ExcelFile)
```

```
##       ID_          gender_              HR_                BP_           
##  Min.   :  1.0   Length:500         Length:500         Length:500        
##  1st Qu.:125.8   Class :character   Class :character   Class :character  
##  Median :250.5   Mode  :character   Mode  :character   Mode  :character  
##  Mean   :250.5                                                           
##  3rd Qu.:375.2                                                           
##  Max.   :500.0                                                           
##      Wgt1_           Wgt2_         Exercise_          Hgt_      
##  Min.   : 49.2   Min.   : 50.2   Min.   : 67.0   Min.   :59.80  
##  1st Qu.:114.3   1st Qu.:115.2   1st Qu.:147.0   1st Qu.:65.00  
##  Median :131.7   Median :133.7   Median :175.5   Median :67.05  
##  Mean   :131.0   Mean   :132.9   Mean   :176.9   Mean   :67.01  
##  3rd Qu.:149.6   3rd Qu.:151.6   3rd Qu.:207.0   3rd Qu.:69.00  
##  Max.   :199.3   Max.   :201.5   Max.   :297.0   Max.   :78.90  
##     Smoke_             Drink_             Group_               WBC_      
##  Length:500         Length:500         Length:500         Min.   : 3851  
##  Class :character   Class :character   Class :character   1st Qu.: 6195  
##  Mode  :character   Mode  :character   Mode  :character   Median : 6902  
##                                                           Mean   : 6896  
##                                                           3rd Qu.: 7532  
##                                                           Max.   :10652  
##     gender       HR         BP      Smoke   Drink       Group    
##  female:500   High: 77   High: 94   N:427   N:140   Control:250  
##               Low : 18   Low : 34   Y: 73   Y:360   Test   :250  
##               Norm:405   Norm:372                                
##                                                                  
##                                                                  
## 
```
  
    
    b. Apply the Low Variance Filter to remove appropriate columns of data.
      -> Removed Hgt column because Height's coef.var value is 0.04.
      

```r
stat.desc(ExcelFile)
```

```
##                         ID_ gender_ HR_ BP_         Wgt1_        Wgt2_
## nbr.val         500.0000000      NA  NA  NA   500.0000000   500.000000
## nbr.null          0.0000000      NA  NA  NA     0.0000000     0.000000
## nbr.na            0.0000000      NA  NA  NA     0.0000000     0.000000
## min               1.0000000      NA  NA  NA    49.2000000    50.200000
## max             500.0000000      NA  NA  NA   199.3000000   201.500000
## range           499.0000000      NA  NA  NA   150.1000000   151.300000
## sum          125250.0000000      NA  NA  NA 65478.0000000 66452.900000
## median          250.5000000      NA  NA  NA   131.6500000   133.700000
## mean            250.5000000      NA  NA  NA   130.9560000   132.905800
## SE.mean           6.4614240      NA  NA  NA     1.1942880     1.198161
## CI.mean.0.95     12.6949496      NA  NA  NA     2.3464527     2.354061
## var           20875.0000000      NA  NA  NA   713.1618677   717.794415
## std.dev         144.4818328      NA  NA  NA    26.7050907    26.791686
## coef.var          0.5767738      NA  NA  NA     0.2039241     0.201584
##                  Exercise_           Hgt_ Smoke_ Drink_ Group_            WBC_
## nbr.val        500.0000000   500.00000000     NA     NA     NA     500.0000000
## nbr.null         0.0000000     0.00000000     NA     NA     NA       0.0000000
## nbr.na           0.0000000     0.00000000     NA     NA     NA       0.0000000
## min             67.0000000    59.80000000     NA     NA     NA    3851.0000000
## max            297.0000000    78.90000000     NA     NA     NA   10652.0000000
## range          230.0000000    19.10000000     NA     NA     NA    6801.0000000
## sum          88440.0000000 33503.40000000     NA     NA     NA 3447776.0000000
## median         175.5000000    67.05000000     NA     NA     NA    6902.0000000
## mean           176.8800000    67.00680000     NA     NA     NA    6895.5520000
## SE.mean          1.8917697     0.13089697     NA     NA     NA      46.1807869
## CI.mean.0.95     3.7168156     0.25717712     NA     NA     NA      90.7327494
## var           1789.3963928     8.56700778     NA     NA     NA 1066332.5403768
## std.dev         42.3012576     2.92694513     NA     NA     NA    1032.6337881
## coef.var         0.2391523     0.04368131     NA     NA     NA       0.1497536
##              gender HR BP Smoke Drink Group
## nbr.val          NA NA NA    NA    NA    NA
## nbr.null         NA NA NA    NA    NA    NA
## nbr.na           NA NA NA    NA    NA    NA
## min              NA NA NA    NA    NA    NA
## max              NA NA NA    NA    NA    NA
## range            NA NA NA    NA    NA    NA
## sum              NA NA NA    NA    NA    NA
## median           NA NA NA    NA    NA    NA
## mean             NA NA NA    NA    NA    NA
## SE.mean          NA NA NA    NA    NA    NA
## CI.mean.0.95     NA NA NA    NA    NA    NA
## var              NA NA NA    NA    NA    NA
## std.dev          NA NA NA    NA    NA    NA
## coef.var         NA NA NA    NA    NA    NA
```

```r
summary(ExcelFile)
```

```
##       ID_          gender_              HR_                BP_           
##  Min.   :  1.0   Length:500         Length:500         Length:500        
##  1st Qu.:125.8   Class :character   Class :character   Class :character  
##  Median :250.5   Mode  :character   Mode  :character   Mode  :character  
##  Mean   :250.5                                                           
##  3rd Qu.:375.2                                                           
##  Max.   :500.0                                                           
##      Wgt1_           Wgt2_         Exercise_          Hgt_      
##  Min.   : 49.2   Min.   : 50.2   Min.   : 67.0   Min.   :59.80  
##  1st Qu.:114.3   1st Qu.:115.2   1st Qu.:147.0   1st Qu.:65.00  
##  Median :131.7   Median :133.7   Median :175.5   Median :67.05  
##  Mean   :131.0   Mean   :132.9   Mean   :176.9   Mean   :67.01  
##  3rd Qu.:149.6   3rd Qu.:151.6   3rd Qu.:207.0   3rd Qu.:69.00  
##  Max.   :199.3   Max.   :201.5   Max.   :297.0   Max.   :78.90  
##     Smoke_             Drink_             Group_               WBC_      
##  Length:500         Length:500         Length:500         Min.   : 3851  
##  Class :character   Class :character   Class :character   1st Qu.: 6195  
##  Mode  :character   Mode  :character   Mode  :character   Median : 6902  
##                                                           Mean   : 6896  
##                                                           3rd Qu.: 7532  
##                                                           Max.   :10652  
##     gender       HR         BP      Smoke   Drink       Group    
##  female:500   High: 77   High: 94   N:427   N:140   Control:250  
##               Low : 18   Low : 34   Y: 73   Y:360   Test   :250  
##               Norm:405   Norm:372                                
##                                                                  
##                                                                  
## 
```

```r
table(ExcelFile$Hgt)
```

```
## 
## 59.8 59.9 60.3 60.6 60.7 60.8 60.9 61.2 61.5 61.6 61.7 61.8 61.9 62.1 62.2 62.4 
##    1    1    1    1    1    2    3    2    1    2    2    1    4    2    2    1 
## 62.5 62.6 62.7 62.9   63 63.1 63.2 63.3 63.4 63.5 63.6 63.7 63.8 63.9   64 64.1 
##    1    1    2    4    4    3    6    3    4    3    4    2    3    9    2    5 
## 64.2 64.3 64.4 64.5 64.6 64.7 64.8   65 65.1 65.2 65.3 65.4 65.5 65.6 65.7 65.8 
##    5    4    7    8    7    7    3    3    6    9    8    1    4    8    5   11 
## 65.9   66 66.1 66.2 66.3 66.4 66.5 66.6 66.7 66.8 66.9   67 67.1 67.2 67.3 67.4 
##    6    7    7    8    4    6    5    5    5   10    3    5    9    8    4    6 
## 67.5 67.6 67.7 67.8 67.9   68 68.1 68.2 68.3 68.4 68.5 68.6 68.7 68.8 68.9   69 
##   10    8    7    7    9    3    6    2    5    4    9    5    5    8    7    5 
## 69.1 69.2 69.3 69.4 69.5 69.6 69.7 69.8 69.9   70 70.1 70.2 70.3 70.4 70.5 70.6 
##    4   11    5    7   12    2    4    4    5    4    2    2    4    6    1    1 
## 70.7 70.8 70.9   71 71.1 71.2 71.3 71.4 71.5 71.6 71.7 71.8 71.9 72.1 72.2 72.3 
##    3    3    3    2    1    3    2    2    2    2    2    2    1    2    2    2 
## 72.4 72.5 72.6 72.8 72.9   73 74.1 74.7 75.6 77.5 78.4 78.9 
##    3    1    1    1    1    1    1    2    1    1    1    1
```

```r
ExcelFile <- ExcelFile[-c(8)]
stat.desc(ExcelFile)
```

```
##                         ID_ gender_ HR_ BP_         Wgt1_        Wgt2_
## nbr.val         500.0000000      NA  NA  NA   500.0000000   500.000000
## nbr.null          0.0000000      NA  NA  NA     0.0000000     0.000000
## nbr.na            0.0000000      NA  NA  NA     0.0000000     0.000000
## min               1.0000000      NA  NA  NA    49.2000000    50.200000
## max             500.0000000      NA  NA  NA   199.3000000   201.500000
## range           499.0000000      NA  NA  NA   150.1000000   151.300000
## sum          125250.0000000      NA  NA  NA 65478.0000000 66452.900000
## median          250.5000000      NA  NA  NA   131.6500000   133.700000
## mean            250.5000000      NA  NA  NA   130.9560000   132.905800
## SE.mean           6.4614240      NA  NA  NA     1.1942880     1.198161
## CI.mean.0.95     12.6949496      NA  NA  NA     2.3464527     2.354061
## var           20875.0000000      NA  NA  NA   713.1618677   717.794415
## std.dev         144.4818328      NA  NA  NA    26.7050907    26.791686
## coef.var          0.5767738      NA  NA  NA     0.2039241     0.201584
##                  Exercise_ Smoke_ Drink_ Group_            WBC_ gender HR BP
## nbr.val        500.0000000     NA     NA     NA     500.0000000     NA NA NA
## nbr.null         0.0000000     NA     NA     NA       0.0000000     NA NA NA
## nbr.na           0.0000000     NA     NA     NA       0.0000000     NA NA NA
## min             67.0000000     NA     NA     NA    3851.0000000     NA NA NA
## max            297.0000000     NA     NA     NA   10652.0000000     NA NA NA
## range          230.0000000     NA     NA     NA    6801.0000000     NA NA NA
## sum          88440.0000000     NA     NA     NA 3447776.0000000     NA NA NA
## median         175.5000000     NA     NA     NA    6902.0000000     NA NA NA
## mean           176.8800000     NA     NA     NA    6895.5520000     NA NA NA
## SE.mean          1.8917697     NA     NA     NA      46.1807869     NA NA NA
## CI.mean.0.95     3.7168156     NA     NA     NA      90.7327494     NA NA NA
## var           1789.3963928     NA     NA     NA 1066332.5403768     NA NA NA
## std.dev         42.3012576     NA     NA     NA    1032.6337881     NA NA NA
## coef.var         0.2391523     NA     NA     NA       0.1497536     NA NA NA
##              Smoke Drink Group
## nbr.val         NA    NA    NA
## nbr.null        NA    NA    NA
## nbr.na          NA    NA    NA
## min             NA    NA    NA
## max             NA    NA    NA
## range           NA    NA    NA
## sum             NA    NA    NA
## median          NA    NA    NA
## mean            NA    NA    NA
## SE.mean         NA    NA    NA
## CI.mean.0.95    NA    NA    NA
## var             NA    NA    NA
## std.dev         NA    NA    NA
## coef.var        NA    NA    NA
```

```r
head(ExcelFile)
```

```
##   ID_ gender_  HR_  BP_ Wgt1_ Wgt2_ Exercise_ Smoke_ Drink_  Group_ WBC_ gender
## 1   1  female Norm Norm 118.6 121.5       158      N      Y Control 5193 female
## 2   2  female Norm Norm 143.1 146.6       152      N      Y Control 5705 female
## 3   3  female Norm High 105.3 107.3       205      N      N    Test 7680 female
## 4   4  female Norm Norm 119.5 120.9       151      N      Y Control 7342 female
## 5   5  female Norm High 130.9 132.1       178      N      N Control 7714 female
## 6   6  female Norm High  90.0  91.4       204      N      Y Control 3851 female
##     HR   BP Smoke Drink   Group
## 1 Norm Norm     N     Y Control
## 2 Norm Norm     N     Y Control
## 3 Norm High     N     N    Test
## 4 Norm Norm     N     Y Control
## 5 Norm High     N     N Control
## 6 Norm High     N     Y Control
```
    c. Apply the High Correlation Filter to remove appropriate columns of data.
      -> Removing Wgt2 fields because Wgt2's correlation is 0.99; which is almost same as 1 for Wgt1.
    




























